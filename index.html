<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <title>ËÇ°Á•®ËßÄÊ∏¨Âπ≥Âè∞</title>
    <script src="https://cdn.jsdelivr.net/npm/apexcharts"></script>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    

    <script>
      const client = supabase.createClient(
        "https://sbzzfjlmhvuchzwqllgf.supabase.co",
        "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InNienpmamxtaHZ1Y2h6d3FsbGdmIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTI3NDE2OTQsImV4cCI6MjA2ODMxNzY5NH0.fvDVLvGLQdMRuCMXmja8ltpXC3TcjZxq78xbnt9Bh-U"
      );
    </script>
    
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css"
    />
    <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
    <script src="https://cdn.jsdelivr.net/npm/flatpickr/dist/l10n/zh-tw.js"></script>


    <link href="/static/style.css" rel="stylesheet" />
  </head>
  <body>
    <!-- <div id="hbdOverlay" class="hbd-overlay">
      <div class="hbd-popup">
        <button
          type="button"
          class="hbd-close-btn"
          aria-label="ÈóúÈñâ"
          onclick="hideHbdPopup()"
        >
          ‚úï
        </button>

        <div class="hbd-title">\È≠èÁæΩÂΩ§/</div>
        <div class="hbd-subtitle">22Ê≠≤ÁîüÊó•Âø´Ê®ÇüéÇHappy Birthday</div>
        <div class="hbd-text">
          Â∏åÊúõ‰Ω†Èõô12È†ÜÂà©Êê∂Âà∞‰æøÂÆúÁöÑAce Pro 2Â∏∂ÂéªÈüìÂúãÊãç
        </div>

        
      </div>
    </div> -->

    <!-- ‰∏äÈù¢ÁöÑ‰∏âÊßìÁôªÂÖ•ÈÅ∏ÂñÆ‰øùÁïô -->
    <div class="menu-container" id="menuContainer">
      <!-- <div class="menu-icon">
        ‚ò∞
        <div class="dropdown round-card" id="dropdownMenu">
          <div id="user-email" style="padding: 8px 15px; font-weight: bold"></div>
          <a href="login.html" id="login-btn">ÁôªÂÖ•</a>
          <a href="register.html" id="register-btn">Ë®ªÂÜä</a>
          <a href="#" id="logout-btn" onclick="logout()" style="display: none">ÁôªÂá∫</a>
        </div>
      </div> -->
    </div>
    <div id="main-content">
  
      <!--  Êñ∞ÁöÑÈ†ÇÈÉ®Â∑•ÂÖ∑Âàó -->
      <div class="top-bar">
        <!-- Â∑¶ÈÇäÂçÄÂ°äÔºöÊêúÂ∞ã + ËÇ°Á•®ÂêçÁ®± + OHLC -->
        <div class="top-left">
          <!-- 1. ÊêúÂ∞ãÂúñÁ§∫ -->
          <button id="searchToggle" class="icon-btn" aria-label="ÊêúÂ∞ã" title="Tap to search for other stocks">
            <svg viewBox="0 0 24 24" class="icon-search">
              <circle
                cx="11"
                cy="11"
                r="6"
                stroke="currentColor"
                stroke-width="2"
                fill="none"
              />
              <line
                x1="16"
                y1="16"
                x2="21"
                y2="21"
                stroke="currentColor"
                stroke-width="2"
              />
            </svg>
          </button>


          <!-- 2. ÊêúÂ∞ãÊ°ÜÔºàÈ†êË®≠Êî∂Ëµ∑ÔºåÁî® .hiddenÔºâ -->
          <div id="searchContainer" class="search-container hidden">
            <div class="search-pill">
              <span class="search-pill-icon">
                <!-- ÈÄôÂÄã SVG ÂèØ‰ª•Áõ¥Êé•Ë§áË£Ω‰Ω† searchToggle Ë£°ÁöÑÈÇ£È°ÜÊîæÂ§ßÈè° -->
                <svg viewBox="0 0 24 24">
                  <circle
                    cx="11"
                    cy="11"
                    r="6"
                    stroke="currentColor"
                    stroke-width="2"
                    fill="none"
                  />
                  <line
                    x1="16"
                    y1="16"
                    x2="21"
                    y2="21"
                    stroke="currentColor"
                    stroke-width="2"
                  />
                </svg>
              </span>

              <input
                autocomplete="off"
                id="symbolInput"
                type="text"
                placeholder="Ëº∏ÂÖ•ËÇ°Á•®ÂêçÁ®±Êàñ‰ª£Ëôü"
              />
            </div>

            <!-- ‰∏ãÊãâÂª∫Ë≠∞‰∏ÄÊ®£ÊîæÈÄôË£°Â∞±Â•Ω -->
            <div id="suggestions"  class="round-card"></div>
          </div>


          <!-- 3. ËÇ°ÂÉπÂêçÁ®± -->
          <div id="chartTitle" class="stock-name"></div>

          <!-- 4. Èñã / È´ò / ‰Ωé / Êî∂ -->
          <div id="ohlcInfo" class="ohlc-info">
            Â∞áÊªëÈº†Êá∏ÂÅúÂú®ÂúñË°®‰∏ä‰ª•Êü•ÁúãË©≥Á¥∞Ë≥áË®ä
          </div>
        </div>

        <!-- Âè≥ÈÇäÂçÄÂ°äÔºöÊôÇÈñìÂàó + Êó•ÊõÜ + È°ØÁ§∫ÂçÄÈöî + ÊéßÂà∂Èù¢Êùø -->
        <div class="top-right">
          <!-- 5. ÊôÇÈñìÂçÄÈñìÊåâÈàï -->
          <div class="time-range-bar">
            <div class="time-range-item" onclick="setActive(this, '5d')">5Â§©</div>
            <div class="time-range-item" onclick="setActive(this, '1m')">1Êúà</div>
            <div class="time-range-item" onclick="setActive(this, '3m')">3Êúà</div>
            <div class="time-range-item" onclick="setActive(this, '6m')">6Êúà</div>
            <div class="time-range-item" onclick="setActive(this, 'ytd')">YTD</div>
            <div class="time-range-item" onclick="setActive(this, '1y')">1Âπ¥</div>
            <div class="time-range-item" onclick="setActive(this, '3y')">3Âπ¥</div>

            <!-- Êó•ÊõÜÊåâÈàï -->
            <div class="calendar-btn" onclick="toggleCustomDate()">
              <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <path
                  d="M19 4h-1V2h-2v2H8V2H6v2H5C3.9 4 3 4.9 3 6v14c0 
                  1.1.9 2 2 2h14c1.1 0 2-.9 
                  2-2V6c0-1.1-.9-2-2-2zm0 
                  16H5V9h14v11z"
                ></path>
              </svg>
            </div>
          </div>
          <!-- Ëá™Ë®ÇÊôÇÈñìÂçÄÂ°äÔºàÁ∂≠ÊåÅÂéüÊú¨ÔºåÈ†êË®≠Èö±ËóèÔºâ -->
          <div id="customDateRange" class="round-card custom-date-card">
            <div class="custom-date-header">Ëá™Ë®ÇÊôÇÈñìÂçÄÈñì</div>

            <div class="custom-date-row">
              <input
                id="customStart"
                class="date-input"
                type="text"
                placeholder="ÈñãÂßãÊó•Êúü"
                readonly
              />
              <span class="date-separator">~</span>
              <input
                id="customEnd"
                class="date-input"
                type="text"
                placeholder="ÁµêÊùüÊó•Êúü"
                readonly
              />
            </div>

            <div class="custom-date-footer">
              <button
                class="date-submit"
                onclick="loadStockWithRange(getSymbol(), 'custom')"
              >
                Êü•Ë©¢
              </button>
            </div>
          </div>
          <!-- 7. ÊéßÂà∂Èù¢ÊùøÊåâÈàï -->
          <button id="controlPanelToggle" class="btn-secondary">
            ÂàÜÊûêÈù¢Êùø
          </button>
        </div>
      </div>

      

      <!--  Â∑¶ÈÇäÂúñ + Âè≥ÈÇäÊéßÂà∂Èù¢Êùø -->
      <div id="chartRow" class="chart-row" >
        <!-- Â∑¶ÈÇäÔºöK Á∑ö + Êàê‰∫§Èáè -->
        <div id="chartArea" class="chart-area">
          <div id="chartsWrap">
            <div id="priceChart"></div>
            <div id="volumeChart"></div>
          </div>
        </div>

        <!-- Âè≥ÈÇäÔºöÊéßÂà∂Èù¢ÊùøÔºàÊäÄË°ìÊåáÊ®ô + ÈÄ≤ÈöéÈÅ∏È†ÖÔºâ -->
        <div id="controlPanel" class="control-panel-right round-card">
          <!-- Á¨¨‰∏ÄÈ†ÖÔºöÊôÇÈñìÂçÄÈöî -->
          <div class="control-section">
            <h3>ÊôÇÈñìÂçÄÈöî</h3>
            <button
              id="togglePeriodsBtn"
              class="btn-secondary"
              onclick="togglePeriods()"
            >
              È°ØÁ§∫ÂçÄÈöî
            </button>
          </div>

          <div class="control-section">
            <h3>È†êÊ∏¨</h3>
            <!-- <button
              id="future30Btn3"
              class="btn-secondary"
              type="button"
            >
              ËàáÊ≠∑Âè≤ËÇ°Á•®ÊØîËºÉË∂®Âã¢
            </button> -->
            <button
              id="future30Btn"
              class="btn-secondary"
              type="button"
            >
              Êú™‰æÜ30Â§©Ë∂®Âã¢
            </button>
            <button
              id="future30Btn2"
              class="btn-secondary"
              type="button"
            >
              Ë≤∑Ë≥£Èªû
            </button>
            <div id="predictionText" style="font-size: 10px; color: #333; padding: 10px;"></div> 
          </div>
          <!-- ‰∏äÔºöÊäÄË°ìÊåáÊ®ô -->
          <div class="control-section">
            
            <h3>È°ØÁ§∫ÊäÄË°ìÁ∑ö</h3>
              <div class="control-section" style="margin-bottom: 10px;">
                <button class="btn-secondary" style="width: 100%; color: #c0392b; border-color: #e74c3c;" onclick="resetAllSelections()">
                  Ê∏ÖÈô§ÊâÄÊúâÈÅ∏È†Ö
                </button>
              </div>
            <div class="checkbox-group">
              <!-- ÈÄôË£°Êää‰Ω†ÂéüÊú¨Âè≥ÂÅ¥ÁöÑ indicator-check ÂÖ®ÈÉ®Êê¨ÈÅé‰æÜ -->
              <label
                ><input class="indicator-check" type="checkbox" value="Sma_5" />
                SMA 5</label
              >
              <label
                ><input class="indicator-check" type="checkbox" value="Sma_10" />
                SMA 10</label
              >
              <label
                ><input class="indicator-check" type="checkbox" value="Sma_20" />
                SMA 20</label
              >
              <label
                ><input class="indicator-check" type="checkbox" value="Sma_60" />
                SMA 60</label
              >
              <label
                ><input
                  class="indicator-check"
                  type="checkbox"
                  value="Sma_120"
                />
                SMA 120</label
              >
              <label
                ><input
                  class="indicator-check"
                  type="checkbox"
                  value="Sma_240"
                />
                SMA 240</label
              >
              <label
                ><input class="indicator-check" type="checkbox" value="DIF" />
                MACD DIF (Âø´Á∑ö)</label
              >
              <label
                ><input class="indicator-check" type="checkbox" value="DEA" />
                MACD DEA (ÊÖ¢Á∑ö)</label
              >
              <label
                ><input class="indicator-check" type="checkbox" value="K" />
                K</label
              >
              <label
                ><input class="indicator-check" type="checkbox" value="D" />
                D</label
              >
              <label
                ><input class="indicator-check" type="checkbox" value="J" />
                J</label
              >
              <label
                ><input class="indicator-check" type="checkbox" value="Bias" />
                Bias</label
              >
            </div>
          </div>


          <!-- ‰∏ãÔºöÈÄ≤ÈöéÈÅ∏È†ÖÔºàÊãñÊõ≥ÂºèÊ¢ù‰ª∂Âà§Êñ∑Ôºâ -->
          <div class="control-section">
            <h3>ÈÄ≤ÈöéÊ¢ù‰ª∂</h3>

            <div class="rule-builder">
              <!-- Â∑¶ÈÇäÔºöÂèØÊãñÊõ≥ÁöÑÊäÄË°ìÊåáÊ®ô chips -->
              <div class="rule-palette">
                <div class="palette-title">ÊääÊåáÊ®ôÊãñÊõ≥Âà∞‰∏ãÊñπÊ¢ù‰ª∂Âè•</div>
                <div class="palette-chips">
                  <!-- ÈÄôË£°ÁöÑ data-field Ë¶ÅÂ∞çÊáâÂæåÁ´ØÊ¨Ñ‰ΩçÂêçÁ®± -->
                  <div
                    class="rule-chip"
                    draggable="true"
                    data-type="indicator"
                    data-field="Sma_5"
                  >
                    SMA 5
                  </div>
                  <div
                    class="rule-chip"
                    draggable="true"
                    data-type="indicator"
                    data-field="Sma_10"
                  >
                    SMA 10
                  </div>
                  <div
                    class="rule-chip"
                    draggable="true"
                    data-type="indicator"
                    data-field="Sma_20"
                  >
                    SMA 20
                  </div>
                  <div
                    class="rule-chip"
                    draggable="true"
                    data-type="indicator"
                    data-field="Sma_60"
                  >
                    SMA 60
                  </div>
                  <div
                    class="rule-chip"
                    draggable="true"
                    data-type="indicator"
                    data-field="Sma_120"
                  >
                    SMA 120
                  </div>
                  <div
                    class="rule-chip"
                    draggable="true"
                    data-type="indicator"
                    data-field="Sma_240"
                  >
                    SMA 240
                  </div>
                  <div
                    class="rule-chip"
                    draggable="true"
                    data-type="indicator"
                    data-field="DIF"
                  >
                    DIF
                  </div>
                  <div
                    class="rule-chip"
                    draggable="true"
                    data-type="indicator"
                    data-field="DEA"
                  >
                    DEA
                  </div>
                  <div
                    class="rule-chip"
                    draggable="true"
                    data-type="indicator"
                    data-field="K"
                  >
                    K
                  </div>
                  <div
                    class="rule-chip"
                    draggable="true"
                    data-type="indicator"
                    data-field="D"
                  >
                    D
                  </div>
                  <div
                    class="rule-chip"
                    draggable="true"
                    data-type="indicator"
                    data-field="J"
                  >
                    J
                  </div>
                  <div
                    class="rule-chip"
                    draggable="true"
                    data-type="indicator"
                    data-field="Bias"
                  >
                    Bias
                  </div>
                </div>
              </div>

              <!-- Âè≥ÈÇäÔºöÊ¢ù‰ª∂Âè•ÂàóË°® -->
              <div class="rule-sentences">
                <!-- Ê®ôÈ°å + Êñ∞Â¢ûÊåâÈàï + AND/OR pill Âêå‰∏ÄË°å -->
                <div class="rule-header-row">
                  <div class="rule-sentences-header">
                    <span>Ê¢ù‰ª∂Âè•</span>
                  </div>

                  <!-- Êñ∞Â¢ûÊåâÈàï + AND/OR pill -->
                  <div class="rule-toolbar">
                    <button
                      type="button"
                      class="btn-secondary2"
                      id="addConditionRowBtn"
                    >
                      + Êñ∞Â¢ûÊ¢ù‰ª∂
                    </button>

                    <!-- AND / OR ÈÅ∏ÊìáÔºåÂ§ñËßÄÊòØ pillÔºåÂØ¶ÈöõÂÄºÂ≠òÂú® hidden input -->
                    <div class="logic-toggle" id="globalLogicToggle">
                      <button
                        type="button"
                        class="logic-option active"
                        data-value="AND"
                      >
                        AND
                      </button>
                      <button
                        type="button"
                        class="logic-option"
                        data-value="OR"
                      >
                        OR
                      </button>
                    </div>

                    <!-- Áµ¶ JS Áî®ÁöÑÈö±ËóèÊ¨Ñ‰Ωç -->
                    <input type="hidden" id="globalLogic" value="AND" />
                  </div>
                </div>

                <!-- Ê¢ù‰ª∂Âè•Ê©´ÂêëÊç≤ÂãïÂçÄ -->
                <div class="rule-list-scroll">
                  <div id="conditionRowsContainer"></div>
                </div>

                <!-- Ê≤íÊúâ‰ªª‰ΩïÊ¢ù‰ª∂ÊàêÁ´ãÊôÇÁöÑÈÄöÁü•ÊñáÂ≠ó -->
                <div id="conditionNoHitMsg" class="condition-nohit-msg" style="display: none;"></div>
                
                <!-- Â∫ï‰∏ãÔºöÊ∏ÖÈô§ / Â•óÁî® -->
                <div class="rule-actions-row">
                  <button
                    type="button"
                    class="btn-secondary"
                    id="clearConditionsBtn"
                  >
                    Ê∏ÖÈô§Ê¢ù‰ª∂
                  </button>
                  <button
                    type="button"
                    class="btn-secondary"
                    id="applyConditionsBtn"
                  >
                    Â•óÁî®Ê¢ù‰ª∂
                  </button>
                </div>
              </div>


            </div>
          </div>

        </div>

      <!--  ÂúñË°®ÔºöK Á∑ö + Êàê‰∫§ÈáèÔºåÊªøÁâàÂØ¨Â∫¶‰∏ä‰∏ãÁñä -->
      <div id="chartsWrap">
        <div id="priceChart"></div>
        <div id="volumeChart"></div>
      </div>
    </div>

    <script src="/static/app.js"></script>
  </body>
</html>
